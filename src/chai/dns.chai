
def dns_query(qclass, qtype, query, settings) {
  return [
    "dns_query",
    qclass,
    qtype,
    query,
    settings
  ]
}

var settings = [
  "dns/nameserver": "8.8.8.8:53",
  "dns/timeout": 0.33,
  "dns/attempts": 1
]

var result = yield_from([
  dns_query("IN", "A", "www.google.com", settings),
  dns_query("IN", "A", "www.torproject.org", settings),
  dns_query("IN", "A", "nexa.polito.it", settings)
])

for (var i = 0; i < result.size; ++i) {
  print(result[i]);
}
