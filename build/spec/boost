#!/bin/sh
set -e

pkg_rootdir=$(cd $(dirname $(dirname $(dirname $0))) && pwd -P)
cd $pkg_rootdir

clone() {
    if [ ! -d third_party/.cache/boost-$1 ]; then
        git clone --recursive --depth 50 --branch master                       \
                https://github.com/boostorg/$1 third_party/.cache/boost-$1
    fi
    rm -rf third_party/boost-$1
    cp -R third_party/.cache/boost-$1 third_party/boost-$1
    if [ ! -z "$2" ]; then
        (cd third_party/boost-$1 && git checkout $2)
    fi
}

clone assert boost-1.59.0
clone config boost-1.59.0
clone core boost-1.59.0-8-g3add966
clone detail boost-1.59.0
clone iterator boost-1.59.0
clone mpl boost-1.59.0
clone predef boost-1.59.0
clone preprocessor boost-1.59.0
clone smart_ptr boost-1.59.0
clone static_assert boost-1.59.0
clone throw_exception boost-1.59.0
clone type_traits boost-1.59.0
clone typeof boost-1.59.0
clone utility boost-1.59.0
install -d $pkg_prefix/include
for dir in third_party/boost-*; do
    cp -R $dir/include/* $pkg_prefix/include
done
