#!/bin/sh
set -e

if [ "$1" = "" ]; then
    echo "usage: $0 spec" 1>&2
    exit 1
fi

ROOTDIR=$(cd $(dirname $0)/../.. && pwd -P)
BUILDDIR=$ROOTDIR/build
IOSDIR=$BUILDDIR/ios

echo ""
echo "Cross-compiling $1 for all platforms and archs"

if [ "$pkg_ios_archs" = "" ]; then
    export pkg_ios_archs="i386 x86_64 armv7 armv7s arm64"
fi
for arch in $pkg_ios_archs; do
    $IOSDIR/cross $arch $BUILDDIR/dependency $1
done
